\documentclass[lang=cn,11pt,a4paper,cite=authoryear]{elegantpaper}

\input{needed.tex}

\title{CMOS模拟集成电路原理\quad 第一周作业}
\author{范云潜 18373486}
\institute{微电子学院 184111 班}
\date{\zhtoday}

\begin{document}

\maketitle

作业内容：❑ 已知要求GBW DM =50MHz，GBW CM =100MHz, C L =5pF。设计一共
模\&差模相位裕度均大于70的运放。通过仿真给出：
▪ 差模增益
▪ 功耗
▪ 共模抑制比CMRR

将上述设计的差分运放，通过电阻设置成10倍放大，观察输入差模和共
模信号分别有100mVpp，10kHz的正弦信号时，差模输出信号的大小，
并分析是否符合预期。

\qfig[00]{hw07p1.png}{题目图}

\listoffigures
% \tableofcontents


\section{分析电路}

M1 与 M2 构成一个 Cascode ，输出到一个共栅极，通过一个源随器和电阻对消除差模，之后通过对电流源的电流吸取，途径 M7 反馈到输出端。那么 \(GBW_{DM} = g_{m1}/2 \pi C_L\) ，\(GBW_{CM} = g_{m7} / 2 \pi 2 C_L\) 。

首先是差模放大部分，其跨导来自于 M1 ，因此为了使得 \(GBW_{DM}\) 大， 应该调大其 \(g_M\) ；同时注意到， 共栅极的 M4 是一个复制管， 和误差放大器的电流应该保持一致；最后是共模反馈部分， 其跨导来自 M7 。综上所述，为了增益带宽积大， 需要调大 M1 和 M7 的电流，为了使得裕度更高， 次级点的电流也应更大。


\section{差模电路}

首先搭建差模电路，如 \figref{02} 。

根据估算， \(g_{M1} = 1.5 m\) ，设置偏置电流。为了使得共栅极放大器工作正常，设置节点 1 的静态电压为 \(0.5 V\) 。为了承载大电流，过驱动电压需要调高，仿真得到 M2 的阈值为 \(0.45 V\) ，设其栅电压为 \(0.65 V\) ； M1 阈值为 \(0.65 V\) ，设其栅电压为 \(0.3 V\) 。求解两个管子的宽长比。

\qfig[02]{hw07p2.png}{差分电路结构}

第二级的电流设置为和第一级几乎吻合，设置 M3 M4 栅电压为 \(1.2 V 1.15 V\) ，求解宽长比。

最终结果如 \figref{03}

\qfig[03]{hw07p3.png}{差分电路参数}

进行交流仿真，观察其增益波形，如 \figref{04}。其增益带宽积和裕度满足要求。

\qfig[04]{hw07p4.png}{差分增益}

\section{共模电路}

将差模电路测试参数写入各个管子，封装为元件，端口如 \figref{05} ，连接共模反馈电路，如 \figref{06} 。共模电路的输入在误差放大器上，是来自于经过电阻消除差模信号后的差分电路输出，通过误差放大器漏极，最终反馈到我们的输出端，关闭其他交流信号，切断回路，在误差放大器加上激励，如 \figref{08}。参数如 \figref{13}

\qfig[05]{hw07p5.png}{差分电路端口图}

\qfig[06]{hw07p6.png}{共模反馈电路}

\qfig[08]{hw07p8.png}{回路切断}

\qfig[13]{hw07p13.png}{共模电路参数}
基于以上的理解，进行对应的 AC 仿真，仿真结果如 \figref{07} ，满足要求。

\qfig[07]{hw07p7.png}{共模增益}

\section{性能分析}

差模增益，在 AC 仿真中设置差分信号 \lstinline{vdif} 的交流振幅为 1 ，增益表达式为 \lstinline{vout/vin} ，仿真结果如 \figref{09} 。

\qfig[09]{hw07p9.png}{差分增益}

功耗，在 OP 仿真可以得到非电流偏置的两条支路的电流为 \(100 \mu A\) 如 \figref{10}，两个电流源分别是 \(400\mu A\) ， \(600 \mu A\) ，总功耗为 \((400 + 600 + 100 \cdot 2) 1.8 \mu W = 2.16 mW\) 。

\qfig[10]{hw07p10.png}{共模反馈电流}

为了更方便的进行 CMRR 仿真，进一步封装模块，如 \figref{11} 。为了进一步的分析，此处的连线是为了使用电阻匹配法，电压仅有共模模式， 如\figref{12}。结果如 \figref{14} 。

\qfig[11]{hw07p11.png}{整体封装}

\qfig[12]{hw07p12.png}{CMRR 连线}

\qfig[14]{hw07p14.png}{CMRR 结果}





% Start Here

% End Here

\end{document}